# Next.js 15 Documentation Cache
*Last Updated: 2025-01-08*
*Source: Vercel Next.js Repository*

## Project Initialization

### create-next-app Command Options
```bash
npx create-next-app@latest [project-name] [options]

Options:
--ts, --typescript           Initialize as TypeScript project (default)
--js, --javascript          Initialize as JavaScript project
--tailwind                  Initialize with Tailwind CSS (default)
--eslint                    Initialize with ESLint config
--app                       Initialize as App Router project
--src-dir                   Initialize inside src/ directory
--import-alias <alias>      Specify import alias (default "@/*")
--use-npm/yarn/pnpm/bun     Specify package manager
--skip-install              Skip installing packages
--yes                       Use defaults without prompting
```

### Manual Project Setup Dependencies
```json
{
  "dependencies": {
    "next": "15.0.3",
    "react": "^18.2.0", 
    "react-dom": "^18.2.0"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0",
    "eslint": "^8.0.0",
    "eslint-config-next": "15.0.3",
    "typescript": "^5.0.0"
  }
}
```

### Package.json Scripts
```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build", 
    "start": "next start",
    "lint": "next lint"
  }
}
```

## Project Structure

### App Router Directory Structure
```
app/
├── layout.tsx              # Root layout (required)
├── page.tsx               # Home page
├── loading.tsx            # Loading UI
├── error.tsx              # Error UI
├── not-found.tsx          # 404 page
├── route.ts               # API endpoint
└── dashboard/
    ├── layout.tsx         # Nested layout
    ├── page.tsx          # Dashboard page
    └── settings/
        └── page.tsx      # Settings page
```

### Top-Level Folders
```
project/
├── app/                   # App Router
├── pages/                 # Pages Router (legacy)
├── public/               # Static assets
├── src/                  # Optional source directory
├── package.json
├── next.config.js
└── tsconfig.json
```

## Root Layout (Required)

### TypeScript Layout
```tsx
export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  )
}
```

### With Global CSS Import
```tsx
import type { Metadata } from 'next'
import './globals.css'

export const metadata: Metadata = {
  title: 'Create Next App',
  description: 'Generated by create next app',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  )
}
```

## TypeScript Configuration

### tsconfig.json for Next.js
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["DOM", "DOM.Iterable", "ES2020"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [{ "name": "next" }],
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```

## Metadata API

### Page Metadata
```tsx
import type { Metadata } from 'next'

export const metadata: Metadata = {
  title: 'Home',
  description: 'Welcome to Next.js',
}

export default function Page() {
  return <h1>Home Page</h1>
}
```

## Client vs Server Components

### Server Component (default)
```tsx
// Server Component - no "use client" directive
async function getData() {
  const res = await fetch('https://api.example.com/data')
  return res.json()
}

export default async function Page() {
  const data = await getData()
  return <div>{data.title}</div>
}
```

### Client Component
```tsx
'use client'

import { useState } from 'react'

export default function ClientComponent() {
  const [count, setCount] = useState(0)
  
  return (
    <button onClick={() => setCount(count + 1)}>
      Count: {count}
    </button>
  )
}
```

## Navigation Hooks (Client Components Only)

```tsx
'use client'

import { useRouter, usePathname, useSearchParams } from 'next/navigation'

export default function NavigationExample() {
  const router = useRouter()
  const pathname = usePathname()
  const searchParams = useSearchParams()

  return (
    <div>
      <p>Current path: {pathname}</p>
      <button onClick={() => router.push('/dashboard')}>
        Go to Dashboard
      </button>
    </div>
  )
}
```

## Route Handlers (API Routes)

### Basic API Route
```ts
// app/api/users/route.ts
export async function GET(request: Request) {
  return Response.json({ message: 'Hello World' })
}

export async function POST(request: Request) {
  const data = await request.json()
  return Response.json({ data })
}
```

## Next.js Configuration

### next.config.ts (TypeScript)
```ts
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  experimental: {
    typedRoutes: true,
  },
  typescript: {
    ignoreBuildErrors: false,
  },
}

export default nextConfig
```

## File Conventions Reference

### Routing Files
- `layout.tsx` - Layout component
- `page.tsx` - Page component  
- `loading.tsx` - Loading UI
- `error.tsx` - Error UI
- `not-found.tsx` - 404 UI
- `route.ts` - API endpoint
- `template.tsx` - Re-rendered layout
- `default.tsx` - Parallel route fallback

### Special Files
- `middleware.ts` - Middleware (project root)
- `instrumentation.ts` - Instrumentation file
- `next.config.js` - Next.js configuration
- `package.json` - Dependencies and scripts
- `tsconfig.json` - TypeScript configuration

## Development Commands

```bash
# Install TypeScript (if needed)
npm install --save-dev typescript @types/react @types/node

# Development server
npm run dev

# Production build
npm run build

# Start production server  
npm run start

# Run linting
npm run lint
```

## Key Next.js 15 Features

1. **App Router** - File-based routing with layouts
2. **Server Components** - React Server Components by default
3. **Streaming** - Progressive page loading
4. **TypeScript First** - Built-in TypeScript support
5. **Metadata API** - Built-in SEO optimization
6. **Edge Runtime** - Deploy to edge locations
7. **Middleware** - Request/response manipulation
8. **Image Optimization** - Automatic image optimization
9. **Font Optimization** - Web font optimization
10. **Bundle Analyzer** - Bundle size analysis

## Best Practices

1. **Use Server Components by default** - Only add "use client" when needed
2. **Colocate files** - Keep related files in same directory
3. **Use TypeScript** - Leverage built-in TypeScript support  
4. **Optimize imports** - Use absolute imports with path mapping
5. **Leverage caching** - Use built-in request caching
6. **Follow file conventions** - Use proper naming for special files
7. **Use Metadata API** - Replace manual head management
8. **Handle loading states** - Implement loading.tsx files
9. **Error boundaries** - Use error.tsx for error handling
10. **Progressive enhancement** - Start with server rendering